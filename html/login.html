<!DOCTYPE html>
<html lang="en" data-theme="emerald">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Highland Fresh Dairy</title>
    <meta name="description" content="Highland Fresh Dairy Production System - Secure Login Portal">

    <!-- Tailwind CSS + DaisyUI CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet" type="text/css" />

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                }
            }
        }
    </script>

    <!-- Inter Font (same as dashboard) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        .login-card {
            transition: all 0.3s ease;
        }

        .demo-btn {
            transition: all 0.2s ease;
        }

        .demo-btn:hover {
            transform: translateY(-1px);
        }
    </style>
</head>

<body class="bg-base-200 min-h-screen">

    <div class="min-h-screen flex">
        <!-- Left Side - Branding (Desktop) -->
        <div class="hidden lg:flex lg:w-1/2 bg-primary relative overflow-hidden">
            <!-- Decorative circles -->
            <div class="absolute w-96 h-96 rounded-full bg-primary-focus/30 -top-20 -left-20"></div>
            <div class="absolute w-64 h-64 rounded-full bg-white/5 bottom-10 right-10"></div>

            <!-- Content -->
            <div class="relative z-10 w-full flex flex-col justify-between p-12">
                <!-- Logo -->
                <div class="flex items-center gap-3">
                    <img src="images/logo.jpg" alt="Highland Fresh Logo" class="w-12 h-12 rounded-xl object-cover">
                    <div>
                        <h1 class="text-2xl font-bold text-white">Highland Fresh</h1>
                        <p class="text-primary-content/70 text-sm">Dairy Production System</p>
                    </div>
                </div>

                <!-- Main Content -->
                <div class="space-y-8">
                    <div>
                        <h2 class="text-4xl font-bold text-white leading-tight mb-4">
                            Fresh Quality,<br />
                            <span class="text-primary-content/80">Trusted Process</span>
                        </h2>
                        <p class="text-primary-content/70 text-lg max-w-md">
                            Complete dairy operations management from farm to table. Track quality, production, and
                            inventory with precision.
                        </p>
                    </div>

                    <!-- Features -->
                    <div class="space-y-4">
                        <div class="flex items-center gap-4 p-4 bg-white/10 rounded-xl">
                            <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-check-circle text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-white font-semibold">Quality Assurance</h3>
                                <p class="text-primary-content/70 text-sm">Real-time milk grading and batch traceability</p>
                            </div>
                        </div>

                        <div class="flex items-center gap-4 p-4 bg-white/10 rounded-xl">
                            <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-industry text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-white font-semibold">Production Control</h3>
                                <p class="text-primary-content/70 text-sm">Recipe management and CCP monitoring</p>
                            </div>
                        </div>

                        <div class="flex items-center gap-4 p-4 bg-white/10 rounded-xl">
                            <div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center">
                                <i class="fas fa-boxes text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-white font-semibold">Inventory Intelligence</h3>
                                <p class="text-primary-content/70 text-sm">FIFO tracking and expiry management</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats -->
                <div class="flex items-center gap-8">
                    <div class="text-center">
                        <div class="text-2xl font-bold text-white">99.5%</div>
                        <div class="text-primary-content/70 text-sm">Quality Rate</div>
                    </div>
                    <div class="w-px h-10 bg-white/20"></div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-white">24/7</div>
                        <div class="text-primary-content/70 text-sm">Monitoring</div>
                    </div>
                    <div class="w-px h-10 bg-white/20"></div>
                    <div class="text-center">
                        <div class="text-2xl font-bold text-white">100%</div>
                        <div class="text-primary-content/70 text-sm">Traceable</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Right Side - Login Form -->
        <div class="w-full lg:w-1/2 flex items-center justify-center p-6 lg:p-12">
            <div class="w-full max-w-md">

                <!-- Mobile Logo -->
                <div class="lg:hidden text-center mb-8">
                    <img src="images/logo.jpg" alt="Highland Fresh Logo" class="w-16 h-16 rounded-2xl object-cover mx-auto mb-4">
                    <h1 class="text-xl font-bold text-base-content">Highland Fresh</h1>
                    <p class="text-base-content/60 text-sm">Dairy Production System</p>
                </div>

                <!-- Login Card -->
                <div class="login-card card bg-base-100 shadow-xl">
                    <div class="card-body p-8">
                        <!-- Header -->
                        <div class="text-center mb-6">
                            <h2 class="text-2xl font-bold text-base-content">Welcome back</h2>
                            <p class="text-base-content/60 mt-1">Enter your credentials to access your account</p>
                        </div>

                        <!-- Alerts -->
                        <div id="loginSuccess" class="alert alert-success mb-4 hidden">
                            <i class="fas fa-check-circle"></i>
                            <span id="successMessage">Login successful! Redirecting...</span>
                        </div>

                        <div id="loginError" class="alert alert-error mb-4 hidden">
                            <i class="fas fa-exclamation-circle"></i>
                            <span id="errorMessage">Invalid username or password</span>
                        </div>

                        <!-- Form -->
                        <form id="loginForm" class="space-y-5">
                            <div class="form-control">
                                <label class="label">
                                    <span class="label-text font-medium">Username</span>
                                </label>
                                <label class="input input-bordered flex items-center gap-3">
                                    <i class="fas fa-user text-base-content/40"></i>
                                    <input type="text" id="username" class="grow" placeholder="Enter your username"
                                        required autofocus />
                                </label>
                            </div>

                            <div class="form-control">
                                <label class="label">
                                    <span class="label-text font-medium">Password</span>
                                </label>
                                <label class="input input-bordered flex items-center gap-3">
                                    <i class="fas fa-lock text-base-content/40"></i>
                                    <input type="password" id="password" class="grow"
                                        placeholder="Enter your password" required />
                                    <button type="button" class="text-base-content/40 hover:text-base-content"
                                        onclick="togglePassword()">
                                        <i id="eyeIcon" class="fas fa-eye"></i>
                                    </button>
                                </label>
                            </div>

                            <div class="flex items-center justify-between">
                                <label class="label cursor-pointer gap-2">
                                    <input type="checkbox" class="checkbox checkbox-primary checkbox-sm" id="rememberMe" />
                                    <span class="label-text">Remember me</span>
                                </label>
                                <a href="#" class="text-sm text-primary hover:underline">Forgot password?</a>
                            </div>

                            <button type="submit" class="btn btn-primary w-full" id="loginBtn">
                                <span id="btnText">Sign In</span>
                                <span id="btnLoading" class="hidden">
                                    <span class="loading loading-spinner loading-sm"></span>
                                    Signing in...
                                </span>
                            </button>
                        </form>

                        <!-- Demo Accounts -->
                        <div class="divider text-sm text-base-content/50">Quick Demo Access</div>

                        <div class="grid grid-cols-2 gap-2">
                            <button type="button"
                                class="demo-btn btn btn-ghost btn-sm gap-2 justify-start"
                                onclick="fillDemo('qc_officer', 'password')">
                                <i class="fas fa-flask text-primary"></i>
                                QC Officer
                            </button>
                            <button type="button"
                                class="demo-btn btn btn-ghost btn-sm gap-2 justify-start"
                                onclick="fillDemo('production_staff', 'password')">
                                <i class="fas fa-cogs text-info"></i>
                                Production
                            </button>
                            <button type="button"
                                class="demo-btn btn btn-ghost btn-sm gap-2 justify-start"
                                onclick="fillDemo('warehouse_raw', 'password')">
                                <i class="fas fa-warehouse text-warning"></i>
                                Warehouse
                            </button>
                            <button type="button"
                                class="demo-btn btn btn-ghost btn-sm gap-2 justify-start"
                                onclick="fillDemo('general_manager', 'password')">
                                <i class="fas fa-user-tie text-secondary"></i>
                                Manager
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Footer -->
                <p class="text-center text-base-content/50 text-sm mt-6">
                    Â© 2026 Highland Fresh Dairy. All rights reserved.
                </p>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="../js/config/api.js"></script>
    <script src="../js/config/auth.js"></script>
    <script>
        // Redirect if already logged in
        if (AuthService.isAuthenticated()) {
            const user = AuthService.getCurrentUser();
            redirectToRoleDashboard(user.role);
        }

        // Toggle password visibility
        function togglePassword() {
            const passwordInput = document.getElementById('password');
            const eyeIcon = document.getElementById('eyeIcon');

            if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                eyeIcon.classList.remove('fa-eye');
                eyeIcon.classList.add('fa-eye-slash');
            } else {
                passwordInput.type = 'password';
                eyeIcon.classList.remove('fa-eye-slash');
                eyeIcon.classList.add('fa-eye');
            }
        }

        // Fill demo credentials
        function fillDemo(username, password) {
            document.getElementById('username').value = username;
            document.getElementById('password').value = password;
        }

        // Handle form submission
        document.getElementById('loginForm').addEventListener('submit', async function (e) {
            e.preventDefault();

            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            const loginBtn = document.getElementById('loginBtn');
            const btnText = document.getElementById('btnText');
            const btnLoading = document.getElementById('btnLoading');
            const errorDiv = document.getElementById('loginError');
            const successDiv = document.getElementById('loginSuccess');

            // Reset alerts
            errorDiv.classList.add('hidden');
            successDiv.classList.add('hidden');

            // Show loading state
            btnText.classList.add('hidden');
            btnLoading.classList.remove('hidden');
            loginBtn.disabled = true;

            try {
                const response = await AuthService.login(username, password);

                if (response.success) {
                    const user = response.data.user;
                    document.getElementById('successMessage').textContent = `Welcome back, ${user.full_name || user.first_name}! Redirecting...`;
                    successDiv.classList.remove('hidden');

                    setTimeout(() => {
                        redirectToRoleDashboard(user.role);
                    }, 1500);
                }
            } catch (error) {
                document.getElementById('errorMessage').textContent = error.message || 'Invalid username or password';
                errorDiv.classList.remove('hidden');

                btnText.classList.remove('hidden');
                btnLoading.classList.add('hidden');
                loginBtn.disabled = false;
            }
        });

        function redirectToRoleDashboard(role) {
            const roleDashboards = {
                'general_manager': 'admin/dashboard.html',
                'qc_officer': 'qc/dashboard.html',
                'production_staff': 'production/dashboard.html',
                'warehouse_raw': 'warehouse/raw/dashboard.html',
                'warehouse_fg': 'warehouse/fg/dashboard.html',
                'sales_custodian': 'sales/dashboard.html',
                'cashier': 'pos/dashboard.html',
                'purchaser': 'purchasing/dashboard.html',
                'finance_officer': 'finance/dashboard.html',
                'maintenance_head': 'maintenance/dashboard.html'
            };

            const dashboard = roleDashboards[role] || 'dashboard.html';
            window.location.href = dashboard;
        }
    </script>
</body>

</html>